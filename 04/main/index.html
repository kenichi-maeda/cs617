<!DOCTYPE html>
  <head>
  <title>CS480 Assignment 4</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@latest"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@latest"></script>
  <script src="https://d3js.org/d3.v6.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollToPlugin.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/MotionPathPlugin.min.js"></script>
  
  <style>
    .panel {
      max-width: 900px;
      margin: 0 auto;
      padding: 30px;
      font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
    }
    .intro {
        padding-top: 30px;
        text-align: center;
    }
    .intro h1 {
      font-size:50px;
    }
    .intro h3 {
      font-size:25px;
    }
    .panel p {
      font-size: 28px;
    }
    #g1 {
      margin-top: 20px;
      display: block;
      text-align: center;
    }
    #g2 {
      margin-top: 20px;
      display: block;
      text-align: center;
    }#g3 {
      margin-top: 20px;
      display: block;
      text-align: center;
    } #g4 {
      margin-top: 20px;
      display: block;
      text-align: center;
    }  #rmp {
      margin-top: 20px;
      display: block;
      text-align: center;
    }.panel {
      padding-top:200px;
      padding-left:100px;
      height: 50%;
      width: 100%;
      background-color: white;
      opacity: 0;
    }  
    
    </style>
  </head>
  <body>
  <div class="article">

    <div id="firstPanel" class="panel" style="padding-top: 0px;">
      <div class="intro">
        <h1>Who earns more at UMass Boston?</h1>
        <h3>Unveiling the Highest Paid Positions & Departments</h3>
        <figure>
          <img src="pic1.jpg" width="400">
          <figcaption>Generated by ChatGPT</figcaption>
        </figure>
      </div>
    </div>

    <div class="panel">
      <p>
        Let's look at Lecturers first.<br> Lecturers at Political Science and Econ Departments earn so well.
      </p>
      <div id="g1"></div>
    </div>

    <div class="panel">
      <p>
        Next, assistant professors. <br>
        The College of Management seems good for this position.
      </p>
      <div id="g2"></div>
    </div>
    

    <div class="panel">
      <p>
        Let's look at associate professors. <br>
        Again, the College of Management dominates the top.<br>
        Does this apply for professors as well?
      </p>
      <div id="g3"></div>
    </div>

    <div class="panel">
      <p>
        Yes, the College of Management still stays the top.
      </p>
      <div id="g4"></div>
    </div>
    

    <div class="panel">
      <p>
        What do students think about them?<br>
      </p>
      <div id="rmp"></div>
    </div>
    
    <div class="panel" style='height:1000px'>
      <p>
        Indeed, professors at the College of Management (CM) get high ratings.<br>
        So, CM seems to be the most successful college at UMass Boston!
      </p>
    </div>

    
    <div id='scrollindicator'><img src='scroll.jpg' style='position:fixed;right:30px;bottom:30px;width:60px;opacity:0.5'></div>
    
  </div>

  <script>
    // Set margin
    const margin1 = {top: 40, right: 50, bottom: 220, left: 190},
        width1 = 560 - margin1.left - margin1.right,
        height1 = 550 - margin1.top - margin1.bottom;

    // append the svg object to the body of the page
    const svg1 = d3.select("#g1")
      .append("svg")
          .attr("width", width1 + margin1.left + margin1.right)
          .attr("height", height1 + margin1.top + margin1.bottom)
      .append("g")
          .attr("transform", `translate(${margin1.left},${margin1.top})`);

    // Add a title
    svg1.append("text")
      .attr("x", width1 / 2)
      .attr("y", 0 - (margin1.top / 2))
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay of Lectureres by Department");

    // x label
    svg1.append("text")
      .attr("x", width1)
      .attr("y", height1 + margin1.top + 10)
      .style("text-anchor", "middle")
      .style("font-size", "14px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Department");

    // y label
    svg1.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0 - margin1.left + 100)
      .attr("x", 0 - (height1 / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "17px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay");


    d3.csv("lecturer.csv").then( function(data) {

      // X axis
      const x = d3.scaleBand()
      .range([ 0, width3 ])
      .domain(data.map(d => d.DEPARTMENT))
      .padding(0.4);
      svg1.append("g")
      .attr("transform", `translate(0,${height1})`)
      .call(d3.axisBottom(x))
      .selectAll("text")
          .attr("transform", "translate(-10,0)rotate(-45)")
          .style("text-anchor", "end")
          .style("font-size", "13px")
          .style("font-family", "Cambria");
          

        // Add Y axis
        const y = d3.scaleLinear()
        .domain([0, 22000])
        .range([ height1, 0]);
        svg1.append("g")
        .call(d3.axisLeft(y));

        // Bars
        svg1.selectAll("mybar")
        .data(data)
        .join("rect")
            .attr("x", d => x(d.DEPARTMENT))
            .attr("width", x.bandwidth())
            .attr("fill", "#1f77b4")
            .attr("height", d => height1 - y(0))
            .attr("y", d => y(0))

        // Animation
        svg1.selectAll("rect")
        .transition()
        .duration(800)
        .attr("y", d => y(d.PAY_TOTAL_ACTUAL))
        .attr("height", d => height1 - y(d.PAY_TOTAL_ACTUAL))
        .delay((d,i) => {console.log(i); return 30+i*120})
    })
  </script>


  <script>
    // Set margin
    const margin2 = {top: 40, right: 50, bottom: 220, left: 190},
        width2 = 560 - margin2.left - margin2.right,
        height2 = 550 - margin2.top - margin2.bottom;

    // append the svg object to the body of the page
    const svg2 = d3.select("#g2")
      .append("svg")
          .attr("width", width2 + margin2.left + margin2.right)
          .attr("height", height2 + margin2.top + margin2.bottom)
      .append("g")
          .attr("transform", `translate(${margin2.left},${margin2.top})`);

    // Add a title
    svg2.append("text")
      .attr("x", width2 / 2)
      .attr("y", 0 - (margin2.top / 2))
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay of Assistant Professors by Department");

    // x label
    svg2.append("text")
      .attr("x", width2)
      .attr("y", height2 + margin2.top + 10)
      .style("text-anchor", "middle")
      .style("font-size", "14px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Department");

    // y label
    svg2.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0 - margin2.left + 100)
      .attr("x", 0 - (height2 / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "17px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay");


    d3.csv("assistant.csv").then( function(data) {

      // X axis
      const x = d3.scaleBand()
      .range([ 0, width3 ])
      .domain(data.map(d => d.DEPARTMENT))
      .padding(0.4);
      svg2.append("g")
      .attr("transform", `translate(0,${height2})`)
      .call(d3.axisBottom(x))
      .selectAll("text")
          .attr("transform", "translate(-10,0)rotate(-45)")
          .style("text-anchor", "end")
          .style("font-size", "13px")
          .style("font-family", "Cambria")
          .style("font-weight", function(d) {
            return d.includes("Management") || d.includes("Finance") || d.includes("Marketing")? "bold" : "normal";
          })
          .style("fill", function(d) {
          return d.includes("Management") || d.includes("Finance") || d.includes("Marketing")? "red" : "black";
          });
          

        // Add Y axis
        const y = d3.scaleLinear()
        .domain([0, 45000])
        .range([ height2, 0]);
        svg2.append("g")
        .call(d3.axisLeft(y));

        // Bars
        svg2.selectAll("mybar")
        .data(data)
        .join("rect")
            .attr("x", d => x(d.DEPARTMENT))
            .attr("width", x.bandwidth())
            .attr("fill", "#2ca02c")
            .attr("height", d => height2 - y(0))
            .attr("y", d => y(0))

        // Animation
        svg2.selectAll("rect")
        .transition()
        .duration(800)
        .attr("y", d => y(d.PAY_TOTAL_ACTUAL))
        .attr("height", d => height2 - y(d.PAY_TOTAL_ACTUAL))
        .delay((d,i) => {console.log(i); return i*120})
    })
  </script>

  <script>
    // Set margin
    const margin3 = {top: 40, right: 50, bottom: 220, left: 190},
        width3 = 560 - margin3.left - margin3.right,
        height3 = 550 - margin3.top - margin3.bottom;

    // append the svg object to the body of the page
    const svg3 = d3.select("#g3")
      .append("svg")
          .attr("width", width3 + margin3.left + margin3.right)
          .attr("height", height3 + margin3.top + margin3.bottom)
      .append("g")
          .attr("transform", `translate(${margin3.left},${margin3.top})`);

    // Add a title
    svg3.append("text")
      .attr("x", width3 / 2)
      .attr("y", 0 - (margin3.top / 2))
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay of Associate Professors by Department");

    // x label
    svg3.append("text")
      .attr("x", width3)
      .attr("y", height3 + margin3.top + 10)
      .style("text-anchor", "middle")
      .style("font-size", "14px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Department");

    // y label
    svg3.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0 - margin3.left + 100)
      .attr("x", 0 - (height3 / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "17px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay");


    d3.csv("associate.csv").then( function(data) {

      // X axis
      const x = d3.scaleBand()
      .range([ 0, width3 ])
      .domain(data.map(d => d.DEPARTMENT))
      .padding(0.4);
      svg3.append("g")
      .attr("transform", `translate(0,${height3})`)
      .call(d3.axisBottom(x))
      .selectAll("text")
          .attr("transform", "translate(-10,0)rotate(-45)")
          .style("text-anchor", "end")
          .style("font-size", "13px")
          .style("font-family", "Cambria")
          .style("font-weight", function(d) {
            return d.includes("Management") || d.includes("Finance")|| d.includes("Marketing") ? "bold" : "normal";
          })
          .style("fill", function(d) {
          return d.includes("Management") || d.includes("Finance") || d.includes("Marketing")? "red" : "black";
          });
          

        // Add Y axis
        const y = d3.scaleLinear()
        .domain([0, 45000])
        .range([ height3, 0]);
        svg3.append("g")
        .call(d3.axisLeft(y));

        // Bars
        svg3.selectAll("mybar")
        .data(data)
        .join("rect")
            .attr("x", d => x(d.DEPARTMENT))
            .attr("width", x.bandwidth())
            .attr("fill", "#ff7f0e")
            .attr("height", d => height3 - y(0))
            .attr("y", d => y(0))

        // Animation
        svg3.selectAll("rect")
        .transition()
        .duration(800)
        .attr("y", d => y(d.PAY_TOTAL_ACTUAL))
        .attr("height", d => height3 - y(d.PAY_TOTAL_ACTUAL))
        .delay((d,i) => {console.log(i); return i*120})
    })
  </script>

  <script>
    // Set margin
    const margin5 = {top: 40, right: 50, bottom: 220, left: 190},
        width5 = 560 - margin5.left - margin5.right,
        height5 = 550 - margin5.top - margin5.bottom;

    // append the svg object to the body of the page
    const svg5 = d3.select("#g4")
      .append("svg")
          .attr("width", width5 + margin5.left + margin5.right)
          .attr("height", height5 + margin5.top + margin5.bottom)
      .append("g")
          .attr("transform", `translate(${margin5.left},${margin5.top})`);

    // Add a title
    svg5.append("text")
      .attr("x", width5 / 2)
      .attr("y", 0 - (margin5.top / 2))
      .attr("text-anchor", "middle")
      .style("font-size", "21px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay of Professors by Department");

    // x label
    svg5.append("text")
      .attr("x", width5)
      .attr("y", height5 + margin5.top + 10)
      .style("text-anchor", "middle")
      .style("font-size", "14px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Department");

    // y label
    svg5.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0 - margin5.left+100)
      .attr("x", 0 - (height5 / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "17px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Pay");


    d3.csv("professor.csv").then( function(data) {

      // X axis
      const x = d3.scaleBand()
      .range([ 0, width5 ])
      .domain(data.map(d => d.DEPARTMENT))
      .padding(0.4);
      svg5.append("g")
      .attr("transform", `translate(0,${height5})`)
      .call(d3.axisBottom(x))
      .selectAll("text")
          .attr("transform", "translate(-10,0)rotate(-45)")
          .style("text-anchor", "end")
          .style("font-size", "13px")
          .style("font-family", "Cambria")
          .style("font-weight", function(d) {
            return d.includes("Management") || d.includes("Finance") || d.includes("Marketing")? "bold" : "normal";
          })
          .style("fill", function(d) {
          return d.includes("Management") || d.includes("Finance") || d.includes("Marketing")? "red" : "black";
          });
          

      // Add Y axis
      const y = d3.scaleLinear()
      .domain([0, 55000])
      .range([ height5, 0]);
      svg5.append("g")
      .call(d3.axisLeft(y));

      // Bars
      svg5.selectAll("mybar")
      .data(data)
      .join("rect")
          .attr("x", d => x(d.DEPARTMENT))
          .attr("width", x.bandwidth())
          .attr("fill", "#69b3a2")
          .attr("height", d => height5 - y(0))
          .attr("y", d => y(0))

      // Animation
      svg5.selectAll("rect")
      .transition()
      .duration(800)
      .attr("y", d => y(d.PAY_TOTAL_ACTUAL))
      .attr("height", d => height5 - y(d.PAY_TOTAL_ACTUAL))
      .delay((d,i) => {console.log(i); return i*120})
    })
  </script>
  <script>
    // Set margin
    const margin4 = {top: 40, right: 50, bottom: 220, left: 100},
        width4 = 560 - margin4.left - margin4.right,
        height4 = 550 - margin4.top - margin4.bottom;

    // append the svg object to the body of the page
    const svg4 = d3.select("#rmp")
      .append("svg")
          .attr("width", width4 + margin4.left + margin4.right)
          .attr("height", height4 + margin4.top + margin4.bottom)
      .append("g")
          .attr("transform", `translate(${margin4.left},${margin4.top})`);
4
    // Add a title
    svg4.append("text")
      .attr("x", width4 / 2)
      .attr("y", 0 - (margin4.top / 2))
      .attr("text-anchor", "middle")
      .style("font-size", "21px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Average Rating by Department");

    // x label
    svg4.append("text")
      .attr("x", width4)
      .attr("y", height4 + margin4.top + 10)
      .style("text-anchor", "middle")
      .style("font-size", "14px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Department");

    // y label
    svg4.append("text")
      .attr("transform", "rotate(-90)")
      .attr("y", 0 - margin4.left + 30)
      .attr("x", 0 - (height4 / 2))
      .attr("dy", "1em")
      .style("text-anchor", "middle")
      .style("font-size", "17px")
      .style("font-family", "Cambria")
      .style("font-weight", "bold") 
      .text("Rating");


    d3.csv("rmp.csv").then( function(data) {

      // X axis
      const x = d3.scaleBand()
      .range([ 0, width4 ])
      .domain(data.map(d => d.DEPARTMENT))
      .padding(0.4);
      svg4.append("g")
      .attr("transform", `translate(0,${height4})`)
      .call(d3.axisBottom(x))
      .selectAll("text")
          .attr("transform", "translate(-10,0)rotate(-45)")
          .style("text-anchor", "end")
          .style("font-size", "13px")
          .style("font-family", "Cambria")
          .style("font-weight", function(d) {
            return d.includes("Management") || d.includes("Finance") ? "bold" : "normal";
          })
          .style("fill", function(d) {
          return d.includes("Management") || d.includes("Finance") ? "red" : "black";
          });

      // Add Y axis
      const y = d3.scaleLinear()
      .domain([0, 5])
      .range([ height4, 0]);
      svg4.append("g")
      .call(d3.axisLeft(y));

      // Bars
      svg4.selectAll("mybar")
      .data(data)
      .join("rect")
          .attr("x", d => x(d.DEPARTMENT))
          .attr("width", x.bandwidth())
          .attr("fill", "#9467bd")
          .attr("height", d => height4 - y(0))
          .attr("y", d => y(0))

      // Animation
      svg4.selectAll("rect")
      .transition()
      .duration(800)
      .attr("y", d => y(d.RATING))
      .attr("height", d => height4 - y(d.RATING))
      .delay((d,i) => {console.log(i); return i*120})
    })
  </script>
  

  <script>
    gsap.registerPlugin(ScrollTrigger);

    // Initially make first panel visible
    gsap.set("#firstPanel", { opacity: 1 });


    gsap.utils.toArray(".panel").forEach((panel, i, panels) => {
        ScrollTrigger.create({
            trigger: panel,
            start: "top top",
            end: "+=50%",
            onEnter: function() {
                gsap.to(panel, {opacity: 1, duration: 1});
            },
            onLeaveBack: () => gsap.to(panel, {opacity: 0, duration: 1}),
            markers: false,
        });
    });

    // Scroll back to top
    gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

    ScrollTrigger.create({
        trigger: document.body,
        start: "bottom bottom",
        once: false,
        onEnter: () => {
            gsap.to(window, {duration: 2, scrollTo: {y: 10}});
        }
    });

  </script>
  </body>
</html>
